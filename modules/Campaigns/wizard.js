/*********************************************************************************
 * SugarCRM Community Edition is a customer relationship management program developed by
 * SugarCRM, Inc. Copyright (C) 2004-2013 SugarCRM Inc.

 * SuiteCRM is an extension to SugarCRM Community Edition developed by Salesagility Ltd.
 * Copyright (C) 2011 - 2014 Salesagility Ltd.
 *
 * This program is free software; you can redistribute it and/or modify it under
 * the terms of the GNU Affero General Public License version 3 as published by the
 * Free Software Foundation with the addition of the following permission added
 * to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK
 * IN WHICH THE COPYRIGHT IS OWNED BY SUGARCRM, SUGARCRM DISCLAIMS THE WARRANTY
 * OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for more
 * details.
 *
 * You should have received a copy of the GNU Affero General Public License along with
 * this program; if not, see http://www.gnu.org/licenses or write to the Free
 * Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
 * 02110-1301 USA.
 *
 * You can contact SugarCRM, Inc. headquarters at 10050 North Wolfe Road,
 * SW2-130, Cupertino, CA 95014, USA. or at email address contact@sugarcrm.com.
 *
 * The interactive user interfaces in modified source and object code versions
 * of this program must display Appropriate Legal Notices, as required under
 * Section 5 of the GNU Affero General Public License version 3.
 *
 * In accordance with Section 7(b) of the GNU Affero General Public License version 3,
 * these Appropriate Legal Notices must retain the display of the "Powered by
 * SugarCRM" logo and "Supercharged by SuiteCRM" logo. If the display of the logos is not
 * reasonably feasible for  technical reasons, the Appropriate Legal Notices must
 * display the words  "Powered by SugarCRM" and "Supercharged by SuiteCRM".
 ********************************************************************************/
function hide(e){var t=document.getElementById(e);t.style.display="none"}function show(e){var t=document.getElementById(e);t&&(t.style.display="")}function showdiv(e){hideall(),show(e)}function hideall(){var e=document.getElementById("wiz_total_steps"),t=parseInt(e.value);for(i=1;i<=t;i++)hide("step"+i)}function showfirst(e){showdiv("step1");var t=document.getElementById("wiz_current_step");t.value="1";var a=document.getElementById("wiz_submit_button"),n=document.getElementById("wiz_next_button"),i=document.getElementById("save_button_div"),l=(document.getElementById("next_button_div"),document.getElementById("back_button_div"));"undefined"!=typeof document.getElementById("wizform").direction?(a.disabled=!0,l.style.display="none",i.style.display="none",n.focus(),"marketing"==e&&(l.style.display="")):l.style.display="none",hilite(t.value)}function navigate(e,t,a){"undefined"==typeof t&&(t=!1),"undefined"==typeof a&&(a=!1);var n=document.getElementById("wiz_current_step"),i=parseInt(n.value),l=$('input[name="record"]').val();l||(l=$('input[name="campaign_id"]').val());var d=validate_wiz(n.value,e);if(t||d){"back"==e&&(n.value=i-1),"next"==e&&(1==i&&(l?a||campaignUpdate():"undefined"!=typeof document.getElementById("wizform").direction&&(a||campaignCreateAndRefreshPage())),n.value=i+1),showdiv("step"+n.value),hilite(n.value);var o=document.getElementById("wiz_total_steps").value,r=document.getElementById("wiz_submit_button"),m=document.getElementById("wiz_submit_finish_button"),u=document.getElementById("back_button_div"),s=document.getElementById("save_button_div"),p=document.getElementById("next_button_div");if(n.value==o)r.disabled=!1,u.style.display="",s.style.display="",p.style.display="none",m&&(m.style.display="none"),"undefined"!=typeof campaignBudget&&campaignBudget&&(m.style.display="");else{n.value<1?u.style.display="none":u.style.display="";var c=document.getElementById("wiz_next_button");if("undefined"!=typeof campaignBudget&&campaignBudget)var _=3;else var _=2;n.value==_?"undefined"!=typeof document.getElementById("wizform").direction&&(p.style.display="none",s.style.display="",$("#wiz_submit_button").removeAttr("disabled")):(p.style.display="",s.style.display="none"),c.focus()}}}function campaignCreateAndRefreshPage(){$('input[name="campaign_id"]').val(GUID());var e=document.getElementById("wizform");"undefined"!=typeof e.direction&&(e.action.value="WizardNewsletterSave",e.direction.value="continue_targetList"),$.post($("#wizform").attr("action"),$("#wizform").serialize(),function(){})}function campaignUpdate(){var e=document.getElementById("wizform");e.action.value="WizardNewsletterSave",e.direction.value="continue",$.post($("#wizform").attr("action"),$("#wizform").serialize(),function(){})}function hilite(e){var t=parseInt(document.getElementById("wiz_total_steps").value);for(i=1;i<=t;i++){var a=document.getElementById("nav_step"+i);a.className=""}var a=document.getElementById("nav_step"+e);a.className="",already_linked.indexOf(e)<0&&(a.innerHTML="<a href='#'  onclick=\"javascript:direct('"+e+"');\">"+a.innerHTML+"</a>",already_linked+=",hilite")}function link_navs(e,t){if(""==e&&(e=1),""==t){var a=document.getElementById("wiz_total_steps").value;t=a}for(e=parseInt(e),t=parseInt(t),i=e;i<=t;i++){var n=document.getElementById("nav_step"+i);n.innerHTML="<a href='#'  onclick=\"javascript:direct('"+i+"');\">"+n.innerHTML+"</a>"}}function direct(e){var t=document.getElementById("wiz_current_step");parseInt(t.value);validate_wiz(t.value,"direct")&&(t.value=e,navigate("direct"))}function validate_wiz(e,t){var a=document.getElementById("wiz_total_steps").value,n=document.getElementById("wiz_message");if("back"==t){if("1"==e){var i=SUGAR.language.get("mod_strings","LBL_WIZARD_FIRST_STEP_MESSAGE");return n.innerHTML="<font color='red' size='2'><b>"+i+"</b></font>",!1}n.innerHTML=""}if("next"==t){if(e==a){var i=SUGAR.language.get("mod_strings","LBL_WIZARD_LAST_STEP_MESSAGE");return n.innerHTML="<font color='red' size='2'><b>"+i+"</b></font>",!1}n.innerHTML=""}return"direct"!=t&&window.validate_wiz_form&&!validate_wiz_form("step"+e)?!1:!0}function GUID(){var e=["a","b","c","d","e","f","1","2","3","4","5","6","7","8","9"],t="0000000-0000-0000-0000-00000000000",a=Array.prototype.map.call(t,function(t){var a=0,n=e.length-1;if("0"==t){var i=Math.round(Math.random()*(n-a)+a);t=e[i]}return t}).toString().replace(/(,)/g,"");return a}var already_linked="",onEmailTemplateChange=function(e,t,a,n){var i=function(){$("#template_id").val()?$('input[name="update_exists_template"]').prop("disabled",!1):($('input[name="update_exists_template"]').prop("checked",!1),$('input[name="update_exists_template"]').prop("disabled",!0))};i(),$('input[name="update_exists_template"]').prop("checked")&&(t="");var l=$(e).val()?$(e).val():"undefined"!=typeof a&&a?a:null;l&&($("#email_template_view_html").html(""),$("#email_template_view").html(""),$.post("index.php?entryPoint=emailTemplateData",{emailTemplateId:l},function(e){var a=JSON.parse(e);if(a.error)console.log(a.error);else{$("#email_template_view_html").html(a.data.body_html),$("#email_template_view").html(a.data.body);var l=$("<textarea />").html(a.data.body_html).text();$("#email_template_editor").html(l),$("#email_template_editor").mozaik(window.mozaikSettings.email_template_editor),$("#template_id").val(a.data.id),$('input[name="update_exists_template"]').prop("checked",!0),i(),$("#template_name").val(($("#update_exists_template").prop("checked")?t:"")+a.data.name),$("#template_subject").val(a.data.subject),"undefined"!=typeof n&&n()}}))},onScheduleClick=function(e){$('input[name="action"]').val("WizardMarketingSave"),$('input[name="module"]').val("Campaigns"),$("#show_wizard_summary").val("1"),$("#sendMarketingEmailSchedule").val("1"),$("#sendMarketingEmailTest").val("0"),$("#wizform").submit()},onSendAsTestClick=function(e,t,a){$('input[name="action"]').val("WizardMarketingSave"),$('input[name="module"]').val("Campaigns"),$("#show_wizard_summary").val("1"),$("#sendMarketingEmailSchedule").val("0"),$("#sendMarketingEmailTest").val("1"),$("#wizform").submit()},addTargetListData=function(e){var t={form_name:"wizform",name_to_value_array:{popup_target_list_id:e,popup_target_list_name:targetListDataJSON[e].name,popup_target_list_type:targetListDataJSON[e].type,popup_target_list_count:targetListDataJSON[e].count},passthru_data:Object(),popupConfirm:0};set_return_prospect_list(t)};$(function(){$("input").keydown(function(e){return 13==e.keyCode?(e.preventDefault(),!1):!0})});